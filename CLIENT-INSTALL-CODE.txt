<!-- 
  КОД ДЛЯ УСТАНОВКИ ВИДЖЕТА НА ОДНУ СТРАНИЦУ ДЛЯ ТЕСТИРОВАНИЯ
  Сайт: nm-shop.by
  Тестовая страница: https://nm-shop.by/kuhonnaya-mebel/kuhnya-variant-fasada-kvadro/
  
  ИНСТРУКЦИЯ:
  1. Откройте файл: catalog/view/theme/[ВАША_ТЕМА]/template/common/header.twig
  2. Найдите строку </head> (обычно в конце файла)
  3. Вставьте весь код ниже ПЕРЕД </head>
  4. Сохраните файл
  5. Очистите кеш OpenCart:
     - Админка → Extensions → Modifications → Refresh
     - Dashboard → Clear cache
  6. Откройте тестовую страницу и проверьте работу виджета
  
  После успешного теста замените этот код на версию для всех страниц.
  
  Опционально:
  - data-avatar="https://nm-shop.by/image/catalog/avatar.jpg" — своя аватарка
  - data-avatar-initials="NM" — fallback текст
  - data-bottom-offset="90" и data-right-offset="20" — если нужно поднять кнопку/подсказку выше нижнего меню
-->

<link rel="preconnect" href="https://widget-nine-murex.vercel.app" crossorigin>
<link rel="preconnect" href="https://api.openai.com" crossorigin>

<script>
(function() {
  if (window.nmShopWidgetLoaded) return;
  
  const TEST_PAGE_URL = '/kuhonnaya-mebel/kuhnya-variant-fasada-kvadro';
  const isTestPage = window.location.href.includes(TEST_PAGE_URL);
  
  if (!isTestPage) {
    console.log('[Widget] Not test page:', window.location.href);
    return;
  }
  
  console.log('[Widget] Loaded on test page');
  window.nmShopWidgetLoaded = true;
  
  const s = document.createElement('script');
  s.src = 'https://widget-nine-murex.vercel.app/widget.js?v=5.1.0';
  s.defer = true;
  s.async = true;
  s.dataset.api = 'https://widget-nine-murex.vercel.app/api/chat';
  s.dataset.prompt = 'https://widget-nine-murex.vercel.app/prompt.json';
  s.dataset.gas = 'https://script.google.com/macros/s/AKfycbxiJrvTNiGfXTbfFWMiTWEGAyh4RKFhoKU8zjIfmQqrZlphC_vdO4R_OS9zhd-gYoZJOw/exec';
  // Необязательно: свой аватар и отступы
  // s.dataset.avatar = 'https://nm-shop.by/image/catalog/avatar.jpg';
  // s.dataset.avatarInitials = 'NM';
  // s.dataset.bottomOffset = '90';
  // s.dataset.rightOffset = '20';
  s.onerror = () => console.warn('[Widget] Failed to load widget.js');
  document.head.appendChild(s);
})();
</script>

<style>
.vfw-root { z-index: 9999999 !important; }
@media (max-width: 768px) {
  .vfw-root { bottom: 80px !important; }
}
.vfw-panel { z-index: 9999999 !important; }
</style>


